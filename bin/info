#!/usr/bin/env python
#-*- coding: utf-8 -*-

"""Show information about the knowhow index.

Usage:
  info
  info (-h | --help)
  info --version

Options:
  -h --help             Show this screen.
  --version             Show version.
"""

from __future__ import absolute_import
from __future__ import print_function
from __future__ import unicode_literals
from __future__ import division

import sys

from docopt import docopt

import knowhow
from knowhow.index import Index


def print_overview(index):
    ix = index.ix
    print('Index:', ix.storage.folder)
    print('Last updated:', index.last_modified(localize=True))
    print('Repo size: %d snippet(s)' % ix.doc_count())
    print()


def print_details(index):
    with index.ix.reader() as reader:
        tags = (t.decode('utf-8') for t in reader.lexicon('tag'))
        print('tags:', ', '.join(tags))
        print('most frequent tags:')
        for count, term in reader.most_frequent_terms('tag'):
            print('  {0}: {1}'.format(int(count), term.decode('utf-8')))


def main(args):
    index = Index()
    print_overview(index)
    print_details(index)
    return 0


if __name__ == '__main__':
    arguments = docopt(__doc__, version=knowhow.__version__)
    sys.exit(main(arguments))
